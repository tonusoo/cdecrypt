# Decrypt Cisco type 7 passwords.
cdecrypt() {

	# Vigenere translation table.
	v=(0x64 0x73 0x66 0x64 0x3b 0x6b 0x66 0x6f 0x41 0x2c 0x2e
	   0x69 0x79 0x65 0x77 0x72 0x6b 0x6c 0x64 0x4a 0x4b 0x44
	   0x48 0x53 0x55 0x42 0x73 0x67 0x76 0x63 0x61 0x36 0x39
	   0x38 0x33 0x34 0x6e 0x63 0x78 0x76 0x39 0x38 0x37 0x33
	   0x32 0x35 0x34 0x6b 0x3b 0x66 0x67 0x38 0x37)


	# Test positional parameters.
	if (( $# == 1 )); then
		case "$1" in
			''|*[!0-9a-fA-F]*)
				echo >&2 'Invalid Cisco type 7 password!'
				return 1
			;;
		esac
	else
		echo >&2 'Provide one Cisco type 7 password!'
		return 1
	fi


	pw="$1"
	i="${pw:0:2}"
	c=2
	r=


	# Decrypt password.
	while (( c < ${#pw} )); do

		printf -v x '%d' "0x"${pw:$c:2}""
		x=$(( x ^ ${v[${i#0}]} ))
		printf -v x '%x' "$x"
		printf -v x "\x"$x""
		r="$r""$x"
		i=$(( ${i#0} + 1 ))
		c=$(( c + 2 ))
		i=$(( ${i#0} % 53 ))

	done

	echo "$r"

}
